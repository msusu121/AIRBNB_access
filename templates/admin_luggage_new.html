{% extends "base.html" %}
{% block title %}New Luggage{% endblock %}
{% block content %}
<div class="bg-white rounded-2xl shadow-sm p-6 max-w-3xl">
  <div class="flex items-center justify-between mb-4">
    <h1 class="text-xl font-semibold">Register Luggage</h1>
    <a href="{{ url_for('luggage.list_') }}" class="text-sm text-slate-600 hover:underline">Back to list</a>
  </div>

  <form method="post" enctype="multipart/form-data" class="space-y-4">
    <div>
      <label class="text-sm block mb-1">Owner</label>
      <div class="flex items-center gap-4">
        <label class="inline-flex items-center gap-2">
          <input type="radio" name="owner_type" value="guest" checked>
          <span class="text-sm">Guest (attached to a booking)</span>
        </label>
        <label class="inline-flex items-center gap-2">
          <input type="radio" name="owner_type" value="host">
          <!-- <span class="text-sm">Host (me)</span>  --> 
        </label>
      </div>
      <p class="text-xs text-slate-500 mt-1">Choose Guest if this is a guest’s item (requires booking). Choose Host for your own item.</p>
    </div>

    <div id="bookingRow">
      <label class="text-sm">Booking (for Guest-owned)</label>
      <select name="booking_id" class="w-full rounded-xl border border-slate-300 px-3 py-2">
        <option value="">Select booking…</option>
        {% for b, room, guest, prop in bookings %}
          <option value="{{ b.id }}">
            #{{ b.id }} — {{ guest.full_name }} • {{ prop.name }} / {{ room.name }} ({{ b.check_in }} → {{ b.check_out }})
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="grid sm:grid-cols-2 gap-4">
      <div>
        <label class="text-sm">Label</label>
        <input name="label" class="w-full rounded-xl border border-slate-300 px-3 py-2" placeholder="e.g. Black Samsonite 24”" required>
      </div>
      <div>
        <label class="text-sm">Size</label>
        <select name="size" class="w-full rounded-xl border border-slate-300 px-3 py-2">
          <option value="small">Small</option>
          <option value="medium" selected>Medium</option>
          <option value="large">Large</option>
          <option value="oversize">Oversize</option>
        </select>
      </div>
    </div>

    <div>
      <label class="text-sm">Photo (optional)</label>
      <input type="file" name="photo" accept="image/*" class="w-full rounded-xl border border-slate-300 px-3 py-2">
      <p class="text-xs text-slate-500 mt-1">Helpful for guards to visually confirm the item.</p>
    </div>

    <div class="pt-2">
      <button class="px-3 py-2 rounded-xl bg-slate-900 text-white text-sm">Create & Generate QR</button>
    </div>
  </form>
</div>

<script>
  // hide booking select when Host is chosen
  const radioGuest = document.querySelector('input[name="owner_type"][value="guest"]');
  const radioHost  = document.querySelector('input[name="owner_type"][value="host"]');
  const bookingRow = document.getElementById('bookingRow');

  function refreshOwner() {
    bookingRow.style.display = radioGuest.checked ? '' : 'none';
  }
  [radioGuest, radioHost].forEach(el => el.addEventListener('change', refreshOwner));
  refreshOwner();
</script>
{% endblock %}
